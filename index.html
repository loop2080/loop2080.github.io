// Koala, Panda, Iguana2
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Responsive Video Layout with Dynamic Transition</title>
  <style>
    /* ---------- DESKTOP (Full-screen video background) ---------- */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #000; /* fallback background */
    }
    /* Video container for desktop */
    #video-container {
      position: absolute;
      top: 50%;
      left: 50%;
      width: auto;
      height: auto;
      min-width: 100%;
      min-height: 100%;
      transform: translate(-50%, -50%);
      z-index: 0;
    }
    /* Video element styling */
    #background-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    /* Video overlay (transition effect) - hidden on desktop */
    #video-overlay {
      display: none;
    }
    /* Logo container at top-left */
    #logo-container {
      position: absolute;
      top: 0;
      left: 5%;
      width: 480px;
      z-index: 1;
      background-color: transparent; /* Desktop: transparent */
    }
    /* Logo image */
    #logo {
      width: 100%;
      height: auto;
      display: block;
    }
    /* Text container at bottom-right */
    #text-container {
      position: absolute;
      right: 5%;
      bottom: 5%;
      width: 300px;
      z-index: 2;
      color: #fff; /* Desktop: white text */
      padding: 15px;
      border-radius: 5px;
      font-family: sans-serif;
      line-height: 1.4;
      background-color: rgba(0, 0, 0, 0.5); /* Desktop static background */
    }
    #text-container h2,
    #text-container p {
      margin: 0 0 10px 0;
    }

    /* ---------- MOBILE and TABLET adjustments (max-width: 1024px) ---------- */
    @media (max-width: 1024px) {
      html, body {
        overflow: auto;
        height: auto;
      }
      /* Mobile body layout */
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      /* Video container in mobile becomes static and takes full width */
      #video-container {
        position: static;
        transform: none;
        width: 100%;
        height: auto;
        min-width: 0;
        min-height: 0;
        order: 4;
        z-index: auto;
      }
      /* Show the video overlay in mobile for the transition effect */
      #video-overlay {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100px; /* Transition over 100px */
        pointer-events: none;
        z-index: 1;
      }
      /* Logo container moves to the top */
      #logo-container {
        position: static;
        width: 100%;
        max-width: 480px;
        order: 1;
        margin: 10px auto;
      }
      /* Text container moves next with extra side padding */
      #text-container {
        position: static;
        width: calc(100% - 40px); /* 20px margin on each side */
        order: 2;
        margin: 10px;
        color: #000; /* Mobile: black text */
        padding: 20px;
        text-align: center; /* Center align heading & tagline */
        background-color: transparent; /* Use body’s dynamic background */
      }
    }
  </style>
</head>
<body>
  <!-- Video container wrapping the video and its overlay -->
  <div id="video-container">
    <!-- Video Background with crossOrigin attribute (if needed) -->
    <video
      id="background-video"
      autoplay
      loop
      muted
      playsinline
      crossOrigin="anonymous"
    >
      <source src="spider1.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
    <!-- Video overlay for mobile transition effect -->
    <div id="video-overlay"></div>
  </div>

  <!-- Logo Container -->
  <div id="logo-container">
    <img src="fixbot logo svg.svg" alt="Fixbot Logo" id="logo" />
  </div>

  <!-- Text Container -->
  <div id="text-container">
    <h2>
      <strong>Revolutionizing Lighting Pole Maintenance with AI & Robotics</strong>
    </h2>
    <p>
      <strong>Fixbot</strong> is transforming the way lighting pole maintenance companies operate.
      Using <strong>cutting-edge AI</strong> and <strong>advanced robotics</strong>, we help businesses
      <strong>optimize efficiency</strong>, reduce costs, and enhance safety. Our
      <strong>smart automation solutions</strong> streamline inspections, repairs, and predictive
      maintenance—minimizing downtime and maximizing performance. Stay ahead with
      <strong>data-driven insights</strong> and precision technology. <strong>Fixbot</strong> is
      the future of smart infrastructure management.
    </p>
    <p><strong>Optimize. Automate. Illuminate.</strong></p>
  </div>

  <!-- Hidden canvas for sampling video frames -->
  <canvas id="video-canvas" style="display: none;"></canvas>

  <script>
    const video = document.getElementById('background-video');
    const canvas = document.getElementById('video-canvas');
    const ctx = canvas.getContext('2d');
    const logoContainer = document.getElementById('logo-container');
    const textContainer = document.getElementById('text-container');
    const videoOverlay = document.getElementById('video-overlay');

    function updateColor() {
      if (video.paused || video.ended) return;

      // Use a small canvas for performance
      const sampleWidth = 160;
      const fullSampleHeight = 90; // height used for drawing the full frame
      const rowsToSample = 5; // only sample the top 5 rows

      canvas.width = sampleWidth;
      canvas.height = fullSampleHeight;

      try {
        ctx.drawImage(video, 0, 0, sampleWidth, fullSampleHeight);
      } catch (error) {
        console.error("Error drawing video frame:", error);
        return;
      }

      try {
        // Get image data from the top 5 rows only
        const frame = ctx.getImageData(0, 0, sampleWidth, rowsToSample);
        const data = frame.data;
        let r = 0, g = 0, b = 0;
        const count = data.length / 4;
        for (let i = 0; i < data.length; i += 4) {
          r += data[i];
          g += data[i + 1];
          b += data[i + 2];
        }
        r = Math.floor(r / count);
        g = Math.floor(g / count);
        b = Math.floor(b / count);
        const avgColor = `rgb(${r}, ${g}, ${b})`;

        if (window.innerWidth <= 1024) {
          // On mobile: update the body background with the dynamic color.
          document.body.style.transition = 'background-color 0.5s ease';
          document.body.style.backgroundColor = avgColor;
          // Ensure logo and text containers remain transparent.
          logoContainer.style.transition = 'background-color 0.5s ease';
          textContainer.style.transition = 'background-color 0.5s ease';
          logoContainer.style.backgroundColor = 'transparent';
          textContainer.style.backgroundColor = 'transparent';
          // Update the video overlay gradient to blend the dynamic color with transparency more gradually.
          videoOverlay.style.transition = 'background-image 0.5s ease';
          // Use multiple stops to smooth the gradient transition.
          videoOverlay.style.backgroundImage = `linear-gradient(to bottom, ${avgColor} 0%, ${avgColor} 60%, transparent 100%)`;
        } else {
          // On desktop: use original static backgrounds.
          document.body.style.backgroundColor = '#000';
          logoContainer.style.backgroundColor = 'transparent';
          textContainer.style.backgroundColor = 'rgba(0,0,0,0.5)';
          videoOverlay.style.backgroundImage = 'none';
        }
      } catch (error) {
        console.error("Error processing image data:", error);
      }
      requestAnimationFrame(updateColor);
    }

    video.addEventListener('play', () => {
      requestAnimationFrame(updateColor);
    });
  </script>
</body>
</html>
